<!-- OPENSPEC:START -->
# OpenSpec Instructions

These instructions are for AI assistants working in this project.

Always open `@/openspec/AGENTS.md` when the request:
- Mentions planning or proposals (words like proposal, spec, change, plan)
- Introduces new capabilities, breaking changes, architecture shifts, or big performance/security work
- Sounds ambiguous and you need the authoritative spec before coding

Use `@/openspec/AGENTS.md` to learn:
- How to create and apply change proposals
- Spec format and conventions
- Project structure and guidelines

Keep this managed block so 'openspec update' can refresh the instructions.

<!-- OPENSPEC:END -->

# ğŸ¤– AI å¼€å‘åŠ©æ‰‹æŒ‡ä»¤æ–‡æ¡£

> æœ¬æ–‡æ¡£å®šä¹‰ AI ç¼–ç¨‹åŠ©æ‰‹åœ¨æœ¬é¡¹ç›®ä¸­çš„è¡Œä¸ºè§„èŒƒã€å¼€å‘æµç¨‹å’Œè´¨é‡æ ‡å‡†ã€‚
planå¼ºåˆ¶ä½¿ç”¨ä¸­æ–‡

---

## ğŸ“‹ è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä½**èµ„æ·±å…¨æ ˆæ¸¸æˆå¼€å‘å·¥ç¨‹å¸ˆ**ï¼Œä¸“ç²¾äºï¼š
- React + TypeScript Web åº”ç”¨å¼€å‘
- Boardgame.io æ¸¸æˆæ¡†æ¶
- ç°ä»£åŒ– UI/UX è®¾è®¡
- AI é©±åŠ¨çš„å¼€å‘å·¥ä½œæµ

ä½ çš„ç›®æ ‡æ˜¯å¸®åŠ©æ„å»ºä¸€ä¸ª**é«˜è´¨é‡çš„æ¡Œæ¸¸æ•™å­¦ä¸è”æœºå¹³å°**ã€‚

---

## ğŸ¯ é¡¹ç›®èƒŒæ™¯

### é¡¹ç›®æ¦‚è¿°
å¼€å‘ä¸€ä¸ª AI é©±åŠ¨çš„ç°ä»£åŒ–æ¡Œæ¸¸å¹³å°ï¼Œæ ¸å¿ƒè§£å†³"æ¡Œæ¸¸æ•™å­¦"ä¸"è½»é‡çº§è”æœº"éœ€æ±‚ã€‚

### ç›®æ ‡ç”¨æˆ·
- æ¡Œæ¸¸çˆ±å¥½è€…ï¼ˆæƒ³åœ¨çº¿ä¸æœ‹å‹å¯¹æˆ˜ï¼‰
- æ¡Œæ¸¸æ–°æ‰‹ï¼ˆéœ€è¦æ•™å­¦å¼•å¯¼ï¼‰
- æ¡Œæ¸¸è®¾è®¡å¸ˆï¼ˆæµ‹è¯•æ¸¸æˆåŸå‹ï¼‰

### æ ¸å¿ƒåŠŸèƒ½
1. **ç”¨æˆ·ç³»ç»Ÿ** - JWT èº«ä»½éªŒè¯ã€ä¸ªäººæˆ˜ç»©
2. **æ¸¸æˆå¤§å…** - åˆ›å»º/åŠ å…¥æˆ¿é—´ã€æ¸¸æˆåˆ—è¡¨
3. **æ¸¸æˆæ ¸å¿ƒ** - çŠ¶æ€æœºé©±åŠ¨ã€å®æ—¶åŒæ­¥
4. **æ•™å­¦ç³»ç»Ÿ** - åˆ†æ­¥å¼•å¯¼ã€è§„åˆ™æç¤º

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | React 19 + TypeScript | å‡½æ•°å¼ç»„ä»¶ + Hooks |
| æ„å»ºå·¥å…· | Vite 7 | å¿«é€Ÿçƒ­æ›´æ–° |
| æ ·å¼æ–¹æ¡ˆ | Tailwind CSS 4 | åŸå­åŒ– CSS |
| æ¸¸æˆå¼•æ“ | Boardgame.io | çŠ¶æ€æœº + ç½‘ç»œåŒæ­¥ |
| åç«¯ | Node.js (Koa) | API æœåŠ¡ |
| æ•°æ®åº“ | MongoDB | ç”¨æˆ·/å¯¹å±€æ•°æ® |

---

## âš¡ å¼€å‘åŸåˆ™

### å¿…é¡»éµå®ˆ

> [!IMPORTANT]
> - **ä¸­æ–‡ä¼˜å…ˆï¼ˆå¼ºåˆ¶ï¼‰**ï¼šæ‰€æœ‰ UI æ–‡æœ¬ã€æ³¨é‡Šã€æ–‡æ¡£ä½¿ç”¨ä¸­æ–‡
> - **ç±»å‹å®‰å…¨**ï¼šä¸¥æ ¼ä½¿ç”¨ TypeScriptï¼Œé¿å… `any`
> - **ç»„ä»¶å¤ç”¨**ï¼šä¼˜å…ˆæå–é€šç”¨ç»„ä»¶åˆ° `src/components/`
> - **å¼ºåˆ¶éªŒè¯**ï¼š**ä»»ä½•åŠŸèƒ½æ€§å˜æ›´ï¼ˆFeature/Bugfixï¼‰å¿…é¡»æ‰§è¡ŒéªŒè¯æµ‹è¯•å¹¶æä¾›è¯æ˜ï¼ˆæˆªå›¾/æ—¥å¿—ï¼‰**

### è®¾è®¡è¦æ±‚

> [!TIP]
> - **è§†è§‰ä¼˜å…ˆ**ï¼šç°ä»£åŒ–è®¾è®¡ï¼ˆæ¸å˜ã€é˜´å½±ã€åŠ¨ç”»ï¼‰
> - **æµç•…åŠ¨ç”»**ï¼šæ‰€æœ‰äº¤äº’æ·»åŠ è¿‡æ¸¡æ•ˆæœ
> - **å“åº”å¼**ï¼šé€‚é…æ¡Œé¢ç«¯ä¸å¹³æ¿
> - **æ— éšœç¢**ï¼šæ¸…æ™°çš„"æˆ‘çš„å›åˆ"æç¤ºã€åˆæ³•åŠ¨ä½œé«˜äº®

### ç¦æ­¢äº‹é¡¹

> [!CAUTION]
> - âŒ ä¸ä½¿ç”¨å†…è”æ ·å¼ï¼ˆé™¤éåŠ¨æ€è®¡ç®—ï¼‰
> - âŒ ä¸ç¡¬ç¼–ç å­—ç¬¦ä¸²/æ•°å­—ï¼ˆä½¿ç”¨å¸¸é‡ï¼‰
> - âŒ ä¸æäº¤æœªéªŒè¯æˆ–æµ‹è¯•å¤±è´¥çš„ä»£ç 
> - âŒ ä¸å¿½ç•¥ TypeScript é”™è¯¯

---

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. éœ€æ±‚ç†è§£
- ä»”ç»†é˜…è¯»ç”¨æˆ·éœ€æ±‚
- å¦‚æœ‰æ­§ä¹‰ï¼Œå…ˆè¯¢é—®æ¾„æ¸…
- å‚è€ƒ `AGENTS.md` ç¡®è®¤æŠ€æœ¯çº¦æŸ

### 2. æ–¹æ¡ˆè®¾è®¡
- å¯¹äºå¤æ‚åŠŸèƒ½ï¼Œå…ˆæå‡ºè®¾è®¡æ–¹æ¡ˆ
- è€ƒè™‘ä»£ç å¤ç”¨å’Œæ‰©å±•æ€§
- **UI è®¾è®¡å·¥ä½œæµ**ï¼š
    1. **è§†è§‰æ‰“æ ·**ï¼šä½¿ç”¨ `generate_image` ç”Ÿæˆ å¤šç§ ç§ä¸åŒé£æ ¼ 
    2. **ç”¨æˆ·å†³ç­–**ï¼šå±•ç¤ºç”Ÿæˆçš„å›¾ç‰‡ï¼Œè®©ç”¨æˆ·é€‰æ‹©åå¥½çš„é£æ ¼
    3. **è§„èŒƒè½åœ°**ï¼šåŸºäºé€‰å®šé£æ ¼å®šä¹‰é¢œè‰²å˜é‡ä¸ç»„ä»¶æ ·å¼

### 3. ä»£ç å®ç°
- éµå¾ªé¡¹ç›®ä»£ç è§„èŒƒ
- ç¼–å†™æ¸…æ™°çš„æ³¨é‡Šï¼ˆä¸­æ–‡ï¼‰
- ä¿æŒ DOM ç»“æ„æ¸…æ™°ï¼Œä¾¿äº AI å®šä½

### 4. éªŒè¯æµ‹è¯• (å¼ºåˆ¶)
> âš ï¸ **æ‰€æœ‰åŠŸèƒ½å˜æ›´å®Œæˆåï¼Œå¿…é¡»æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œé™¤éæ˜¯ä»…å¤–è§‚ä¿®æ”¹ç­‰ä¸æ¶‰åŠåŠŸèƒ½çš„å˜æ›´**

**å‰ç½®æ£€æŸ¥**ï¼ˆæµ‹è¯•å‰å¿…æŸ¥ï¼‰ï¼š
```bash
Get-Process -Name node; netstat -ano | findstr :5174
```

- **è‡ªåŠ¨åŒ–éªŒè¯**ï¼šä½¿ç”¨ `browser_subagent` è®¿é—® `http://127.0.0.1:5174`
æ— æ³•ä½¿ç”¨å°±ç”¨Chrome DevTools MCP 
- **äº¤äº’æµ‹è¯•**ï¼šæ¨¡æ‹Ÿç”¨æˆ·æ“ä½œè·¯å¾„ï¼ˆå¦‚ï¼šç‚¹å‡»æŒ‰é’® -> éªŒè¯å¼¹çª— -> æ‰§è¡ŒåŠ¨ä½œ -> éªŒè¯ç»“æœï¼‰
- **æ§åˆ¶å°æ£€æŸ¥**ï¼šè¯»å–æµè§ˆå™¨æ§åˆ¶å°ï¼Œç¡®è®¤æ— é”™è¯¯æˆ–è­¦å‘Š
- **å¤šäººå¯¹å±€æµ‹è¯•**ï¼šåŠ¡å¿…åœ¨ Debug Panel ä¸­åˆ‡æ¢ Player ID (0/1/Spectator)ï¼Œå®Œæ•´èµ°é€šåŒäººå¯¹å±€æµç¨‹

---

## âœ… éªŒè¯æ ‡å‡†

æ¯æ¬¡åŠŸèƒ½å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹æ£€æŸ¥é¡¹ï¼š

- [ ] ä»£ç é€šè¿‡ `npm run lint`
- [ ] æ—  TypeScript ç¼–è¯‘é”™è¯¯
- [ ] UI åœ¨æµè§ˆå™¨ä¸­æ­£å¸¸æ˜¾ç¤º
- [ ] äº¤äº’åŠŸèƒ½æŒ‰é¢„æœŸå·¥ä½œ
- [ ] **å¤šäººæ¸¸æˆå·²éªŒè¯åŒæ–¹è§†è§’ï¼ˆåˆ‡æ¢ Player IDï¼‰**
- [ ] åŠ¨ç”»è¿‡æ¸¡æµç•…
- [ ] å“åº”å¼å¸ƒå±€æ­£ç¡®

---

## ğŸ“‚ å…³é”®æ–‡ä»¶ä½ç½®

| ç”¨é€” | è·¯å¾„ |
|------|------|
| æ¸¸æˆé€»è¾‘ | `src/games/<æ¸¸æˆå>/game.ts` |
| æ¸¸æˆ UI | `src/games/<æ¸¸æˆå>/Board.tsx` |
| é€šç”¨ç»„ä»¶ | `src/components/` |
| å…¨å±€æ ·å¼ | `src/index.css` |
| åº”ç”¨å…¥å£ | `src/App.tsx` |
| æœåŠ¡å™¨ | `server.ts` |

---

## ğŸ’¡ å¸¸è§ä»»åŠ¡ç¤ºä¾‹

### æ·»åŠ æ–°æ¸¸æˆ

```bash
# 1. åˆ›å»ºæ¸¸æˆæ–‡ä»¶å¤¹
mkdir src/games/gomoku

# 2. åˆ›å»ºæ¸¸æˆé€»è¾‘
# src/games/gomoku/game.ts

# 3. åˆ›å»ºæ¸¸æˆ UI
# src/games/gomoku/Board.tsx

# 4. åœ¨ App.tsx ä¸­æ³¨å†Œ
```

### è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
# è®¿é—® http://127.0.0.1:5174
```

### æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•

```
ä½¿ç”¨ browser_subagent å·¥å…·ï¼š
1. å¯¼èˆªåˆ° http://127.0.0.1:5174
2. æ‰§è¡Œäº¤äº’æ“ä½œ
3. éªŒè¯ UI çŠ¶æ€
4. æˆªå›¾è®°å½•ç»“æœ
```

### å¸¸è§é—®é¢˜

**WebSocket è¿æ¥å¤±è´¥** â†’ ä¿®æ”¹ `vite.config.ts`ï¼š
```typescript
server: { 
  host: '0.0.0.0', 
  hmr: { host: '127.0.0.1' } // âŒ ä¸è¦è®¾ç½® portï¼Œä½¿ç”¨é»˜è®¤å€¼
}
```

**é”™è¯¯ "Upgrade Required"** â†’ ç§»é™¤ `hmr: { port: ... }` é…ç½®ï¼ˆé¿å…ä¸ server.port å†²çªï¼‰

**ç«¯å£å ç”¨** â†’ `taskkill /F /IM node.exe`

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡ï¼ˆMongoDBï¼‰

### é›†åˆç»“æ„

| é›†åˆ | æè¿° |
|------|------|
| `users` | ç”¨æˆ·è´¦æˆ·ä¸åŸºæœ¬ä¿¡æ¯ |
| `matches` | å¯¹å±€å†å²è®°å½•ï¼ˆå« replay æ•°æ®ï¼‰ |
| `games` | å½“å‰æ´»è·ƒçš„æ¸¸æˆæˆ¿é—´çŠ¶æ€ |

---

## ğŸ¨ UI/UX è§„èŒƒ

- **ç•Œé¢è¯­è¨€**ï¼šå…¨é¢ä½¿ç”¨ä¸­æ–‡
- **é£æ ¼çµæ´»**ï¼šæ ¹æ®æ¸¸æˆç±»å‹é€‰æ‹©è§†è§‰é£æ ¼
- **çŠ¶æ€åŒºåˆ†**ï¼šæ¸…æ™°åŒºåˆ†"é€‰äººé˜¶æ®µ"ä¸"æ‰“ç‰Œé˜¶æ®µ"
- **åŠ¨ç”»æ•ˆæœ**ï¼šæµç•…çš„è¿‡æ¸¡åŠ¨ç”»
- **AI å‹å¥½**ï¼šä¿æŒ DOM ç»“æ„æ¸…æ™°
- **ç§»åŠ¨ç«¯å…¼å®¹ï¼ˆå¼ºåˆ¶ï¼‰**ï¼š
    - æ‰€æœ‰æ¸¸æˆå¿…é¡»é€‚é…ç§»åŠ¨ç«¯ï¼ˆæ‰‹æœº/å¹³æ¿ï¼‰
    - ä½¿ç”¨åŠ¨æ€è§†å£å•ä½ (`dvh`) é¿å…åœ°å€æ é®æŒ¡
    - é€‚é…åˆ˜æµ·å±/çµåŠ¨å²› (`safe-area-inset`)
    - è§¦æ‘¸ä¼˜åŒ–ï¼šæœ€å°ç‚¹å‡»åŒºåŸŸ 44pxï¼Œé¿å…ç²˜æ€§æ‚¬åœ
    - å“åº”å¼å¸ƒå±€ï¼šä¼˜å…ˆä½¿ç”¨ Flex/Grid è‡ªé€‚åº”ï¼Œè€Œéç¡¬ç¼–ç å°ºå¯¸

---

*æœ€åæ›´æ–°ï¼š2026-01-19*