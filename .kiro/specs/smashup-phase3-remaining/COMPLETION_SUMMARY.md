# Smash Up Phase 3 å‰©ä½™èƒ½åŠ› - å®Œæˆæ€»ç»“

## ğŸ“Š å®ŒæˆçŠ¶æ€

**æ€»ä½“è¿›åº¦**: 17/17 æ ¸å¿ƒä»»åŠ¡å®Œæˆ âœ…  
**æµ‹è¯•çŠ¶æ€**: 44 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ727 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ âœ…  
**ä»£ç è´¨é‡**: é‡å¤ä»£ç å·²æ¸…ç†ï¼Œé—ç•™ TODO å·²å¤„ç† âœ…

---

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. Complete the Ritual æ”¾ç‰Œåº“åº•ä¿®æ­£
- âœ… ä¿®æ”¹ä¸ºä½¿ç”¨ `CARD_TO_DECK_BOTTOM` äº‹ä»¶
- âœ… åˆ é™¤è¿‡æ—¶æ³¨é‡Š
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆï¼ˆæ ‡è®°ä¸º `*`ï¼‰

### 2. æ¯æ˜ŸåŠ›é‡â‰¤2 æ ¡éªŒ
- âœ… å®ç°åŠ›é‡é™åˆ¶æ ¡éªŒ
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 3. Full Sail å¤šæ­¥ç§»åŠ¨
- âœ… éªŒè¯å®Œæ•´æ€§ï¼Œç¡®è®¤ `movedUids` ä¼ é€’å’Œ `done` é€‰é¡¹
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 4. Furthering the Cause ç²¾ç¡®è§¦å‘
- âœ… éªŒè¯ `turnDestroyedMinions` è¿½è¸ªé€»è¾‘
- âš ï¸ å¯é€‰å±æ€§æµ‹è¯•æœªå®Œæˆ

### 5. åŸºç¡€ç‰ˆåŸºåœ°èƒ½åŠ› Prompt åŒ–
- âœ… æµ·ç›—æ¹¾ï¼ˆbase_pirate_coveï¼‰
- âœ… æ‰˜å°”å›¾åŠ ï¼ˆbase_tortugaï¼‰
- âœ… å·«å¸ˆå­¦é™¢ï¼ˆbase_wizard_academyï¼‰
- âœ… è˜‘è‡ç‹å›½ï¼ˆbase_mushroom_kingdomï¼‰
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 6. å…‹è‹é²æ‰©å±•åŸºåœ°èƒ½åŠ›
- âœ… ç–¯äººé™¢ï¼ˆbase_the_asylumï¼‰
- âœ… å°æ–¯èŒ…æ–¯åŸºåœ°ï¼ˆbase_innsmouth_baseï¼‰
- âœ… å¯†å¤§åŸºåœ°ï¼ˆbase_miskatonic_university_baseï¼‰
- âœ… å†·åŸé«˜åœ°ï¼ˆbase_plateau_of_lengï¼‰
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 7. AL9000 æ‰©å±•åŸºåœ°èƒ½åŠ›
- âœ… æ¸©å®¤ï¼ˆbase_greenhouseï¼‰
- âœ… ç¥ç§˜èŠ±å›­ï¼ˆbase_secret_gardenï¼‰
- âœ… å‘æ˜å®¶æ²™é¾™ï¼ˆbase_inventors_salonï¼‰
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 8. Pretty Pretty æ‰©å±•åŸºåœ°èƒ½åŠ›
- âœ… è¯¡çŒ«å··ï¼ˆbase_cat_fanciers_alleyï¼‰
- âœ… ä¹å‘½ä¹‹å±‹ï¼ˆbase_house_of_nine_livesï¼‰
- âœ… é­”æ³•æ—åœ°ï¼ˆbase_enchanted_gladeï¼‰
- âœ… ä»™çµä¹‹ç¯ï¼ˆbase_fairy_ringï¼‰
- âœ… å¹³è¡¡ä¹‹åœ°ï¼ˆbase_land_of_balanceï¼‰
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 9. è¢«åŠ¨ä¿æŠ¤ç±»åŸºåœ°èƒ½åŠ›
- âœ… ç¾ä¸½åŸå ¡ï¼ˆbase_beautiful_castleï¼‰
- âœ… å°é©¬ä¹å›­ï¼ˆbase_pony_paradiseï¼‰
- âš ï¸ å¯é€‰æµ‹è¯•ä»»åŠ¡æœªå®Œæˆ

### 10. å¡ç‰Œå±•ç¤ºç³»ç»Ÿï¼ˆUI + é¢†åŸŸå±‚ï¼‰
- âœ… REVEAL_HAND / REVEAL_DECK_TOP äº‹ä»¶
- âœ… pendingReveal çŠ¶æ€ç®¡ç†
- âœ… playerView è¿‡æ»¤
- âœ… Alien Probe èƒ½åŠ›
- âœ… Alien Scout Ship èƒ½åŠ›
- âœ… Book of Iter èƒ½åŠ›å¢å¼º
- âœ… CardRevealOverlay UI ç»„ä»¶
- âœ… Board.tsx é›†æˆ
- âœ… DISMISS_REVEAL å‘½ä»¤
- âœ… Vitest é›†æˆæµ‹è¯•ï¼ˆ10 ä¸ªæµ‹è¯•ï¼‰

### 11. ç–¯ç‹‚å¡å¹³å±€è§„åˆ™
- âœ… isGameOver ä¸­å®ç°å¹³å±€è§„åˆ™
- âœ… Vitest æµ‹è¯•è¦†ç›–ï¼ˆ3 ä¸ªåœºæ™¯ï¼‰

### 12. Full Sail Special æ—¶æœºæ ‡æ³¨
- âœ… æ·»åŠ æ¸…æ™°çš„ TODO æ³¨é‡Š + æ¸…ç†è§¦å‘æ¡ä»¶

### 13. ä»£ç æ¸…ç†
- âœ… æ¸…ç† baseAbilities.ts TODO æ³¨é‡Š
- âœ… æ¸…ç†é‡å¤çš„ `applyEvents` å‡½æ•°ï¼ˆ10 ä¸ªæ–‡ä»¶ï¼‰
- âœ… æ¸…ç†é‡å¤çš„å·¥å‚å‡½æ•°ï¼ˆ6 ä¸ªæ–‡ä»¶ï¼‰
- âœ… æ›´æ–°è¿‡æ—¶çš„ TODO æ³¨é‡Šï¼ˆmadness.ts, cthulhu.tsï¼‰

---

## âš ï¸ æœªå®Œæˆçš„å¯é€‰æµ‹è¯•ä»»åŠ¡

ä»¥ä¸‹æµ‹è¯•ä»»åŠ¡æ ‡è®°ä¸º `*`ï¼ˆå¯é€‰ï¼‰ï¼Œç”¨äºåŠ é€Ÿ MVP äº¤ä»˜ã€‚è¿™äº›æµ‹è¯•å¯ä»¥åœ¨åç»­è¿­ä»£ä¸­è¡¥å……ï¼š

### æµ‹è¯•æ–‡ä»¶æ¸…å•

1. **Complete the Ritual æµ‹è¯•** (ä»»åŠ¡ 1.2)
   - æ–‡ä»¶ï¼š`src/games/smashup/__tests__/cthulhuExpansionAbilities.test.ts`
   - éªŒè¯ï¼šCARD_TO_DECK_BOTTOM äº‹ä»¶ç±»å‹

2. **æ¯æ˜ŸåŠ›é‡æ ¡éªŒæµ‹è¯•** (ä»»åŠ¡ 2.2)
   - éªŒè¯ï¼šåŠ›é‡â‰¤2 å…è®¸ã€åŠ›é‡>2 æ‹’ç»

3. **Full Sail æµ‹è¯•** (ä»»åŠ¡ 4.2)
   - æ–‡ä»¶ï¼š`src/games/smashup/__tests__/pirateFullSail.test.ts`
   - éªŒè¯ï¼šç§»åŠ¨1ä¸ª/å¤šä¸ªéšä»ã€é€‰æ‹©å®Œæˆã€æ— éšä»è¾¹ç•Œ

4. **Furthering the Cause å±æ€§æµ‹è¯•** (ä»»åŠ¡ 5.2)
   - éªŒè¯ï¼šVP åˆ¤å®šã€turnDestroyedMinions è¿½è¸ªå’Œæ¸…ç©º

5. **åŸºç¡€ç‰ˆåŸºåœ°èƒ½åŠ›æµ‹è¯•** (ä»»åŠ¡ 6.5)
   - æ–‡ä»¶ï¼š`src/games/smashup/__tests__/newBaseAbilities.test.ts`
   - è¦†ç›–ï¼šæµ·ç›—æ¹¾/æ‰˜å°”å›¾åŠ /å·«å¸ˆå­¦é™¢/è˜‘è‡ç‹å›½

6. **å…‹è‹é²æ‰©å±•åŸºåœ°æµ‹è¯•** (ä»»åŠ¡ 8.6)
   - æ–‡ä»¶ï¼š`src/games/smashup/__tests__/expansionBaseAbilities.test.ts`
   - è¦†ç›–ï¼šç–¯äººé™¢/å°æ–¯èŒ…æ–¯/å¯†å¤§åŸºåœ°/å†·åŸé«˜åœ°

7. **AL9000 æ‰©å±•åŸºåœ°æµ‹è¯•** (ä»»åŠ¡ 9.4)
   - è¦†ç›–ï¼šæ¸©å®¤/ç¥ç§˜èŠ±å›­/å‘æ˜å®¶æ²™é¾™

8. **Pretty Pretty æ‰©å±•åŸºåœ°æµ‹è¯•** (ä»»åŠ¡ 10.6)
   - è¦†ç›–ï¼šè¯¡çŒ«å··/ä¹å‘½ä¹‹å±‹/é­”æ³•æ—åœ°/ä»™çµä¹‹ç¯/å¹³è¡¡ä¹‹åœ°

9. **è¢«åŠ¨ä¿æŠ¤ç±»åŸºåœ°æµ‹è¯•** (ä»»åŠ¡ 12.3)
   - éªŒè¯ï¼šç¾ä¸½åŸå ¡åŠ›é‡â‰¥5 ä¿æŠ¤ã€å°é©¬ä¹å›­ 2+ éšä»ä¿æŠ¤

10. **å¡ç‰Œå±•ç¤ºç³»ç»Ÿæµ‹è¯•** (ä»»åŠ¡ 13.9)
    - å·²æœ‰ Vitest é›†æˆæµ‹è¯•ï¼ˆrevealSystem.test.tsï¼‰
    - å¯é€‰ï¼šPlaywright E2E æµ‹è¯•ï¼ˆéœ€åŒäººè”æœºè®¾ç½®ï¼‰

---

## ğŸ”§ ä¿ç•™çš„åˆç† TODO

ä»¥ä¸‹ TODO æ ‡æ³¨äº†éœ€è¦å¼•æ“å±‚æ”¯æŒçš„æœªæ¥å¢å¼ºåŠŸèƒ½ï¼š

### 1. ä¹å‘½ä¹‹å±‹å¼‚æ­¥æ‹¦æˆªæœºåˆ¶
**ä½ç½®**: `src/games/smashup/domain/baseAbilities_expansion.ts:447`
```typescript
// TODO: å®Œæ•´å®ç°åº”ç”Ÿæˆ Prompt è®©ç©å®¶é€‰æ‹©æ˜¯å¦ç§»åŠ¨ï¼Œéœ€è¦å¼‚æ­¥æ‹¦æˆªæœºåˆ¶æ”¯æŒ
```
**è¯´æ˜**: å½“å‰ MVP å®ç°ä¸ºè‡ªåŠ¨ç§»åŠ¨ï¼Œå®Œæ•´å®ç°éœ€è¦å¼•æ“æ”¯æŒå¼‚æ­¥æ‹¦æˆªå™¨ï¼ˆåœ¨äº‹ä»¶å¤„ç†ä¸­æš‚åœå¹¶ç­‰å¾…ç©å®¶é€‰æ‹©ï¼‰ã€‚

### 2. Full Sail Special æ—¶æœº
**ä½ç½®**: `src/games/smashup/abilities/pirates.ts:186`
```typescript
// TODO: pirate_full_sail special æ—¶æœºï¼ˆåŸºåœ°è®¡åˆ†å‰æ‰“å‡ºï¼‰
// è§„åˆ™ï¼šFull Sail æ˜¯ special è¡ŒåŠ¨å¡ï¼Œåº”åœ¨åŸºåœ°è®¡åˆ†å‰ï¼ˆbeforeScoringï¼‰æ‰“å‡ºã€‚
// å½“å‰å®ç°ä¸º onPlayï¼ˆæ‰‹åŠ¨æ‰“å‡ºï¼‰ï¼Œéœ€è¦ beforeScoring é˜¶æ®µçš„ special action æœºåˆ¶æ”¯æŒã€‚
// æ¸…ç†è§¦å‘æ¡ä»¶ï¼šå½“ special action æœºåˆ¶ï¼ˆå…è®¸åœ¨ beforeScoring é˜¶æ®µä»æ‰‹ç‰Œæ‰“å‡º special å¡ï¼‰å®ç°åå›å¡«ã€‚
```
**è¯´æ˜**: éœ€è¦å¼•æ“æ”¯æŒ beforeScoring é˜¶æ®µçš„ special action æœºåˆ¶ã€‚

### 3. Alien Probe é¢å¤–åŠŸèƒ½
**ä½ç½®**: `src/games/smashup/abilities/aliens.ts:209`
```typescript
// TODO: Probe è¿˜éœ€è¦æŸ¥çœ‹ç‰Œåº“é¡¶å¹¶é€‰æ‹©æ”¾å›é¡¶éƒ¨æˆ–åº•éƒ¨ï¼ˆéœ€è¦é¢å¤– Prompt æµç¨‹ï¼Œå¾… pendingReveal ç¡®è®¤åè§¦å‘ï¼‰
```
**è¯´æ˜**: å½“å‰å®ç°äº†æŸ¥çœ‹å¯¹æ‰‹æ‰‹ç‰Œï¼Œå®Œæ•´è§„åˆ™è¿˜åŒ…æ‹¬æŸ¥çœ‹ç‰Œåº“é¡¶å¹¶é€‰æ‹©æ”¾å›ä½ç½®ã€‚

---

## ğŸ“ å…³é”®æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒå®ç°æ–‡ä»¶
- `src/games/smashup/domain/baseAbilities.ts` - åŸºç¡€ç‰ˆåŸºåœ°èƒ½åŠ›
- `src/games/smashup/domain/baseAbilities_expansion.ts` - æ‰©å±•åŒ…åŸºåœ°èƒ½åŠ›
- `src/games/smashup/abilities/cthulhu.ts` - å…‹è‹é²æ´¾ç³»èƒ½åŠ›
- `src/games/smashup/abilities/pirates.ts` - æµ·ç›—æ´¾ç³»èƒ½åŠ›
- `src/games/smashup/abilities/aliens.ts` - å¤–æ˜Ÿäººæ´¾ç³»èƒ½åŠ›
- `src/games/smashup/abilities/miskatonic.ts` - å¯†å¤§æ´¾ç³»èƒ½åŠ›
- `src/games/smashup/domain/types.ts` - ç±»å‹å®šä¹‰ï¼ˆå« REVEAL äº‹ä»¶ï¼‰
- `src/games/smashup/domain/reducer.ts` - äº‹ä»¶å¤„ç†
- `src/games/smashup/domain/reduce.ts` - çŠ¶æ€å½’çº¦
- `src/games/smashup/domain/commands.ts` - å‘½ä»¤æ ¡éªŒ
- `src/games/smashup/domain/index.ts` - æ¸¸æˆé€»è¾‘å…¥å£ï¼ˆå« isGameOverï¼‰
- `src/games/smashup/ui/CardRevealOverlay.tsx` - å¡ç‰Œå±•ç¤º UI
- `src/games/smashup/Board.tsx` - æ¸¸æˆé¢æ¿ï¼ˆé›†æˆ CardRevealOverlayï¼‰

### æµ‹è¯•æ–‡ä»¶
- `src/games/smashup/__tests__/helpers.ts` - å…±äº«æµ‹è¯•å·¥å…·ï¼ˆå·²æ¸…ç†é‡å¤ï¼‰
- `src/games/smashup/__tests__/revealSystem.test.ts` - å¡ç‰Œå±•ç¤ºç³»ç»Ÿæµ‹è¯•ï¼ˆ10 ä¸ªæµ‹è¯•ï¼‰
- `src/games/smashup/__tests__/*.test.ts` - 44 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ727 ä¸ªæµ‹è¯•

### æ•°æ®æ–‡ä»¶
- `src/games/smashup/data/factions/madness.ts` - ç–¯ç‹‚å¡å®šä¹‰

---

## ğŸ¯ åç»­å»ºè®®

### ä¼˜å…ˆçº§ 1ï¼šè¡¥å……å¯é€‰æµ‹è¯•
å¦‚æœéœ€è¦æ›´å®Œæ•´çš„æµ‹è¯•è¦†ç›–ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºè¡¥å……ï¼š

1. **åŸºåœ°èƒ½åŠ›æµ‹è¯•** (ä»»åŠ¡ 6.5, 8.6, 9.4, 10.6)
   - è¿™äº›æ˜¯æ–°å¢çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæµ‹è¯•è¦†ç›–æœ‰åŠ©äºå›å½’éªŒè¯
   - å¯ä»¥å‚è€ƒç°æœ‰çš„ `newBaseAbilities.test.ts` æ¨¡å¼

2. **å±æ€§æµ‹è¯•** (ä»»åŠ¡ 5.2)
   - Furthering the Cause çš„ turnDestroyedMinions è¿½è¸ªé€»è¾‘
   - å¯ä»¥ä½¿ç”¨ fast-check è¿›è¡Œå±æ€§æµ‹è¯•

3. **è¾¹ç•Œæµ‹è¯•** (ä»»åŠ¡ 2.2, 4.2)
   - æ¯æ˜ŸåŠ›é‡æ ¡éªŒã€Full Sail è¾¹ç•Œæƒ…å†µ

### ä¼˜å…ˆçº§ 2ï¼šå¼•æ“å¢å¼º
å¦‚æœè¦å®ç°ä¿ç•™çš„ TODO åŠŸèƒ½ï¼Œéœ€è¦å¼•æ“å±‚æ”¯æŒï¼š

1. **å¼‚æ­¥æ‹¦æˆªå™¨æœºåˆ¶**
   - å…è®¸æ‹¦æˆªå™¨æš‚åœäº‹ä»¶å¤„ç†å¹¶ç­‰å¾…ç©å®¶é€‰æ‹©
   - ç”¨äºä¹å‘½ä¹‹å±‹ç­‰éœ€è¦ç©å®¶ç¡®è®¤çš„æ‹¦æˆªåœºæ™¯

2. **beforeScoring é˜¶æ®µ special action**
   - å…è®¸åœ¨åŸºåœ°è®¡åˆ†å‰ä»æ‰‹ç‰Œæ‰“å‡º special å¡
   - ç”¨äº Full Sail ç­‰ special æ—¶æœºå¡ç‰Œ

3. **å¤šæ­¥ Prompt é“¾**
   - æ”¯æŒ Prompt ç¡®è®¤åè§¦å‘æ–°çš„ Prompt
   - ç”¨äº Alien Probe æŸ¥çœ‹æ‰‹ç‰Œåé€‰æ‹©ç‰Œåº“é¡¶æ”¾å›ä½ç½®

### ä¼˜å…ˆçº§ 3ï¼šE2E æµ‹è¯•
- å¡ç‰Œå±•ç¤ºç³»ç»Ÿçš„ Playwright E2E æµ‹è¯•
- éœ€è¦åŒäººè”æœºè®¾ç½®ï¼Œä¸”ä¾èµ–éšæœºæŠ½å¡ï¼ˆAliens æ´¾ç³» + Probe/Scout Shipï¼‰
- å½“å‰ Vitest é›†æˆæµ‹è¯•å·²æä¾›å¯é è¦†ç›–

---

## ğŸ“Š ç»Ÿè®¡æ•°æ®

- **æ ¸å¿ƒä»»åŠ¡**: 17/17 å®Œæˆ (100%)
- **å¯é€‰æµ‹è¯•ä»»åŠ¡**: 0/10 å®Œæˆ (0%)
- **æµ‹è¯•æ–‡ä»¶**: 44 ä¸ª
- **æµ‹è¯•ç”¨ä¾‹**: 727 ä¸ªï¼ˆå…¨éƒ¨é€šè¿‡ï¼‰
- **ä»£ç æ¸…ç†**: 16 ä¸ªæ–‡ä»¶ï¼ˆåˆ é™¤é‡å¤ä»£ç ï¼‰
- **ä¿ç•™ TODO**: 3 ä¸ªï¼ˆéœ€å¼•æ“æ”¯æŒï¼‰

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®ç°
- [x] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [x] ä»£ç é‡å¤å·²æ¸…ç†
- [x] é—ç•™ TODO å·²å¤„ç†æˆ–æ ‡æ³¨æ¸…æ™°
- [x] UI ç»„ä»¶å·²å®ç°å¹¶é›†æˆ
- [x] æ–‡æ¡£å·²æ›´æ–°

**ç»“è®º**: Smash Up Phase 3 å‰©ä½™èƒ½åŠ› spec çš„æ ¸å¿ƒåŠŸèƒ½å·²å…¨éƒ¨å®Œæˆï¼Œå¯ä»¥äº¤ä»˜ä½¿ç”¨ã€‚å¯é€‰æµ‹è¯•ä»»åŠ¡å¯åœ¨åç»­è¿­ä»£ä¸­æ ¹æ®éœ€è¦è¡¥å……ã€‚
